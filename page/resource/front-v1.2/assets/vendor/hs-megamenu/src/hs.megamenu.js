(function(d){function e(a,c){var b=this;this.$element=d(a);this.options=d.extend(!0,{},e.defaults,c);this._items=d();Object.defineProperties(this,{itemsSelector:{get:function(){return b.options.classMap.hasSubMenu+","+b.options.classMap.hasMegaMenu}},_tempChain:{value:null,writable:!0},state:{value:null,writable:!0}});this.initialize()}function g(a,c,b,d){var f=this;this.$element=a;this.menu=c;this.options=b;this.$container=d;Object.defineProperties(this,{itemClass:{get:function(){return f.options.type===
"mega-menu"?f.options.classMap.hasMegaMenu:f.options.classMap.hasSubMenu}},activeItemClass:{get:function(){return f.options.type==="mega-menu"?f.options.classMap.hasMegaMenuActive:f.options.classMap.hasSubMenuActive}},menuClass:{get:function(){return f.options.type==="mega-menu"?f.options.classMap.megaMenu:f.options.classMap.subMenu}},isOpened:{get:function(){return this.$element.hasClass(this.activeItemClass.slice(1))}}});this.menu.addClass("animated").on("click.HSMegaMenu",function(){f._updateMenuBounds()});
this.$element.data("max-width")&&this.menu.css("max-width",this.$element.data("max-width"));this.$element.data("position")&&this.menu.addClass("hs-position-"+this.$element.data("position"));if(this.options.animationOut)this.menu.on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(a){f.menu.hasClass(f.options.animationOut)&&(f.$element.removeClass(f.activeItemClass.slice(1)),f.options.afterClose.call(f,f.$element,f.menu));f.menu.hasClass(f.options.animationIn)&&
f.options.afterOpen.call(f,f.$element,f.menu);a.stopPropagation();a.preventDefault()})}function h(){return"ontouchstart"in window}e.defaults={event:"hover",direction:"horizontal",breakpoint:991,animationIn:!1,animationOut:!1,rtl:!1,hideTimeOut:300,sideBarRatio:0.25,pageContainer:d("body"),classMap:{initialized:".hs-menu-initialized",mobileState:".hs-mobile-state",subMenu:".hs-sub-menu",hasSubMenu:".hs-has-sub-menu",hasSubMenuActive:".hs-sub-menu-opened",megaMenu:".hs-mega-menu",hasMegaMenu:".hs-has-mega-menu",
hasMegaMenuActive:".hs-mega-menu-opened"},mobileSpeed:400,mobileEasing:"linear",beforeOpen:function(){},beforeClose:function(){},afterOpen:function(){},afterClose:function(){}};e.prototype.initialize=function(){var a=this,c=d(window);this.options.rtl&&this.$element.addClass("hs-rtl");this.$element.addClass(this.options.classMap.initialized.slice(1)).addClass("hs-menu-"+this.options.direction);c.on("resize.HSMegaMenu",function(){a.resizeTimeOutId&&clearTimeout(a.resizeTimeOutId);a.resizeTimeOutId=
setTimeout(function(){window.innerWidth<=a.options.breakpoint&&a.state=="desktop"?a.initMobileBehavior():window.innerWidth>a.options.breakpoint&&a.state=="mobile"&&a.initDesktopBehavior();a.refresh()},50)});d(document).on("click.HSMegaMenu",function(b){var c=d(b.target).parents(a.itemsSelector);a.closeAll(c.add(d(b.target)))}).on("keyup.HSMegaMenu",function(b){b.keyCode&&b.keyCode==27&&a.closeAll()});window.innerWidth<=this.options.breakpoint?this.initMobileBehavior():window.innerWidth>this.options.breakpoint&&
this.initDesktopBehavior();this.smartPositions();return this};e.prototype.smartPositions=function(){var a=this;this.$element.find(this.options.classMap.subMenu).each(function(c,b){g.smartPosition(d(b),a.options)})};e.prototype.bindEvents=function(){var a=this;if(this.options.event==="hover"&&!h())this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(c){var b=d(this),e=b.parents(a.itemsSelector);
b.data("HSMenuItem")||a.initMenuItem(b,a.getType(b));e=e.add(b);a.closeAll(e);e.each(function(a,b){var c=d(b).data("HSMenuItem");c.hideTimeOutId&&clearTimeout(c.hideTimeOutId);c.show()});a._items=a._items.not(e);a._tempChain=e;c.preventDefault();c.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(c){var b=d(this).data("HSMenuItem"),e=d(c.relatedTarget).parents(a.itemsSelector);
b.hideTimeOutId=setTimeout(function(){a.closeAll(e)},a.options.hideTimeOut);a._items=a._items.add(a._tempChain);a._tempChain=null;c.preventDefault();c.stopPropagation()}).on("click.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="click"] > a, '+this.options.classMap.hasSubMenu+'[data-event="click"] > a',function(c){var b=d(this).parent('[data-event="click"]');b.data("HSMenuItem")||a.initMenuItem(b,a.getType(b));a.closeAll(b.add(b.parents(a.itemsSelector)));b=b.data("HSMenuItem");b.isOpened?
b.hide():b.show();c.preventDefault();c.stopPropagation()});else if(this.$element.on("click.HSMegaMenu",h()?this.options.classMap.hasMegaMenu+" > a, "+this.options.classMap.hasSubMenu+" > a":this.options.classMap.hasMegaMenu+':not([data-event="hover"]) > a,'+this.options.classMap.hasSubMenu+':not([data-event="hover"]) > a',function(c){var b=d(this).parent();b.parents(a.itemsSelector);b.data("HSMenuItem")||a.initMenuItem(b,a.getType(b));a.closeAll(b.add(b.parents(a.itemsSelector)));b=b.addClass("hs-event-prevented").data("HSMenuItem");
b.isOpened?b.hide():b.show();c.preventDefault();c.stopPropagation()}),!h())this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(c){var b=d(this),e=b.parents(a.itemsSelector);b.data("HSMenuItem")||a.initMenuItem(b,a.getType(b));a.closeAll(b.add(e));e.add(b).each(function(a,b){var c=d(b).data("HSMenuItem");c.hideTimeOutId&&clearTimeout(c.hideTimeOutId);c.show()});c.preventDefault();c.stopPropagation()}).on("mouseleave.HSMegaMenu",
this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(c){d(this).data("HSMenuItem").hideTimeOutId=setTimeout(function(){a.closeAll(d(c.relatedTarget).parents(a.itemsSelector))},a.options.hideTimeOut);c.preventDefault();c.stopPropagation()})};e.prototype.initMenuItem=function(a,c){var b=new g(a,a.children(this.options.classMap[c==="mega-menu"?"megaMenu":"subMenu"]),d.extend(!0,{type:c},this.options,a.data()),this.$element);a.data("HSMenuItem",
b);this._items=this._items.add(a)};e.prototype.initMobileBehavior=function(){var a=this;this.state="mobile";this.$element.off(".HSMegaMenu").addClass(this.options.classMap.mobileState.slice(1)).on("click.HSMegaMenu",a.options.classMap.hasSubMenu+" > a, "+a.options.classMap.hasMegaMenu+" > a",function(c){var b=d(this).parent();b.data("HSMenuItem")||a.initMenuItem(b,a.getType(b));a.closeAll(b.parents(a.itemsSelector).add(b));b=b.data("HSMenuItem");console.log(b.isOpened);b.isOpened?b.mobileHide():b.mobileShow();
c.preventDefault();c.stopPropagation()}).find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide()};e.prototype.initDesktopBehavior=function(){this.state="desktop";this.$element.removeClass(this.options.classMap.mobileState.slice(1)).off(".HSMegaMenu").find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+
","+this.options.classMap.megaMenu).hide();this.bindEvents()};e.prototype.closeAll=function(a){var c=this;return this._items.not(a&&a.length?a:d()).each(function(a,e){d(e).removeClass("hs-event-prevented").data("HSMenuItem")[c.state=="mobile"?"mobileHide":"hide"]()})};e.prototype.getType=function(a){return!a||!a.length?null:a.hasClass(this.options.classMap.hasSubMenu.slice(1))?"sub-menu":a.hasClass(this.options.classMap.hasMegaMenu.slice(1))?"mega-menu":null};e.prototype.getState=function(){return this.state};
e.prototype.refresh=function(){return this._items.add(this._tempChain).each(function(a,c){d(c).data("HSMenuItem")._updateMenuBounds()})};g.prototype.show=function(){if(!this.menu.length)return this;this.$element.addClass(this.activeItemClass.slice(1));this.options.direction=="horizontal"&&this.smartPosition(this.menu,this.options);this._updateMenuBounds();this.options.animationOut?this.menu.removeClass(this.options.animationOut):this.options.afterOpen.call(this,this.$element,this.menu);this.options.animationIn&&
this.menu.addClass(this.options.animationIn);return this};g.prototype.hide=function(){if(!this.menu.length)return this;this.options.animationOut||this.$element.removeClass(this.activeItemClass.slice(1));this.options.animationIn&&this.menu.removeClass(this.options.animationIn);this.options.animationOut?this.menu.addClass(this.options.animationOut):this.options.afterClose.call(this,this.$element,this.menu);return this};g.prototype.mobileShow=function(){var a=this;if(!this.menu.length)return this;this.menu.removeClass(this.options.animationIn).removeClass(this.options.animationOut).stop().slideDown({duration:a.options.mobileSpeed,
easing:a.options.mobileEasing,complete:function(){a.options.afterOpen.call(a,a.$element,a.menu)}});this.$element.addClass(this.activeItemClass.slice(1));return this};g.prototype.mobileHide=function(){var a=this;if(!this.menu.length)return this;this.menu.stop().slideUp({duration:a.options.mobileSpeed,easing:a.options.mobileEasing,complete:function(){a.options.afterClose.call(a,a.$element,a.menu)}});this.$element.removeClass(this.activeItemClass.slice(1));return this};g.prototype.smartPosition=function(a,
c){g.smartPosition(a,c)};g.smartPosition=function(a,c){if(a||a.length)d(window),a.removeClass("hs-reversed"),c.rtl?a.offset().left<0&&a.addClass("hs-reversed"):a.offset().left+a.outerWidth()>window.innerWidth&&a.addClass("hs-reversed")};g.prototype._updateMenuBounds=function(){var a="auto";if(this.options.direction=="vertical"&&this.options.type=="mega-menu"){if(this.$container&&this.$container.data("HSMegaMenu").getState()=="desktop"){if(!this.options.pageContainer.length)this.options.pageContainer=
d("body");a=this.options.pageContainer.outerWidth()*(1-this.options.sideBarRatio)}else a="auto";this.menu.css({width:a,height:"auto"});this.menu.outerHeight()>this.$container.outerHeight()||this.menu.css("height","100%")}};d.fn.HSMegaMenu=function(a){return this.each(function(){var c=d(this);c.data("HSMegaMenu")||c.data("HSMegaMenu",new e(c,a))})}})(jQuery);