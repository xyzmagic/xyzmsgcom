(function(d){d.HSCore.components.HSCountdown={_baseConfig:{yearsElSelector:".years",monthsElSelector:".months",daysElSelector:".days",hoursElSelector:".hours",minutesElSelector:".minutes",secondsElSelector:".seconds",circles:!1,wrpClass:"wrpClass",textClass:"textClass",valueStrokeClass:"valueStrokeClass",maxValueStrokeClass:"maxValueStrokeClass",styleWrapper:"styleWrapper",styleText:"styleText"},pageCollection:d(),_circlesIds:[0],init:function(a,b){this.collection=a&&d(a).length?d(a):d();if(d(a).length)return this.config=
b&&d.isPlainObject(b)?d.extend({},this._baseConfig,b):this._baseConfig,this.config.itemSelector=a,this.initCountdowns(),this.pageCollection},initCountdowns:function(){var a=this;this.collection.each(function(b,f){var c=d(f),e={endDate:c.data("end-date")?new Date(c.data("end-date")):new Date,startDate:c.data("start-date")?new Date(c.data("start-date")):new Date,yearsEl:c.find(a.config.yearsElSelector),yearsFormat:c.data("years-format"),monthsEl:c.find(a.config.monthsElSelector),monthsFormat:c.data("months-format"),
daysEl:c.find(a.config.daysElSelector),daysFormat:c.data("days-format"),hoursEl:c.find(a.config.hoursElSelector),hoursFormat:c.data("hours-format"),minutesEl:c.find(a.config.minutesElSelector),minutesFormat:c.data("minutes-format"),secondsEl:c.find(a.config.secondsElSelector),secondsFormat:c.data("seconds-format")};a.config.circles&&c.data("start-date")?a._initPiesImplementation(c,e):a._initBaseImplementation(c,e);a.pageCollection=a.pageCollection.add(c)})},_initBaseImplementation:function(a,b){a.countdown(b.endDate,
function(a){b.yearsEl.length&&b.yearsEl.text(a.strftime(b.yearsFormat));b.monthsEl.length&&b.monthsEl.text(a.strftime(b.monthsFormat));b.daysEl.length&&b.daysEl.text(a.strftime(b.daysFormat));b.hoursEl.length&&b.hoursEl.text(a.strftime(b.hoursFormat));b.minutesEl.length&&b.minutesEl.text(a.strftime(b.minutesFormat));b.secondsEl.length&&b.secondsEl.text(a.strftime(b.secondsFormat))})},_initPiesImplementation:function(a,b){b.yearsEl.length&&this._preparePieItem(b.yearsEl,{maxValue:b.endDate.getFullYear()-
b.startDate.getFullYear(),radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")});b.monthsEl.length&&this._preparePieItem(b.monthsEl,{maxValue:Math.round(Math.abs((b.endDate.getTime()-b.startDate.getTime())/864E5))/12,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),
"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")});b.daysEl.length&&this._preparePieItem(b.daysEl,{maxValue:this._getDaysMaxValByFormat(b.daysFormat,b.startDate,b.endDate),radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")});b.hoursEl.length&&
this._preparePieItem(b.hoursEl,{maxValue:60,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")});b.minutesEl.length&&this._preparePieItem(b.minutesEl,{maxValue:60,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),
"font-size":a.data("circles-font-size")});b.secondsEl.length&&this._preparePieItem(b.secondsEl,{maxValue:60,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")});a.countdown(b.endDate,function(a){b.yearsEl.length&&b.yearsEl.data("circle").update(a.strftime(b.yearsFormat));b.monthsEl.length&&b.monthsEl.data("circle").update(a.strftime(b.monthsFormat));
b.daysEl.length&&b.daysEl.data("circle").update(a.strftime(b.daysFormat));b.hoursEl.length&&b.hoursEl.data("circle").update(a.strftime(b.hoursFormat));b.minutesEl.length&&b.minutesEl.data("circle").update(a.strftime(b.minutesFormat));b.secondsEl.length&&b.secondsEl.data("circle").update(a.strftime(b.secondsFormat))})},_preparePieItem:function(a,b){var d=this._circlesIds[this._circlesIds.length-1]+1;this._circlesIds.push(d);a.attr("id","hs-countdown-element-"+d);a.data("circle",Circles.create({id:"hs-countdown-element-"+
d,radius:b.radius||80,value:0,maxValue:b.maxValue||100,width:b.width||10,text:function(a){return a+(b["additional-text"]||"")},colors:[b["bg-color"]||"#eeeeee",b["fg-color"]||"#72c02c"],duration:0,wrpClass:this.config.wrpClass,textClass:this.config.textClass,valueStrokeClass:this.config.valueStrokeClass,maxValueStrokeClass:this.config.maxValueStrokeClass,styleWrapper:this.config.styleWrapper,styleText:this.config.styleText}));b["font-size"]&&a.find("."+this.config.textClass).css("font-size",b["font-size"]+
"px")},_getDaysMaxValByFormat:function(a,b,d){switch(a){case "%D":return Math.round(Math.abs((d.getTime()-b.getTime())/864E5));default:return 31}}}})(jQuery);