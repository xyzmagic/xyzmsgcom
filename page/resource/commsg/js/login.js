function loginReady(){$("#user").bind("focus",function(){tips=$("#tips-error");tips.text("")});$("#password").bind("focus",function(){tips=$("#tips-error");tips.text("")});document.onkeydown=function(){event.keyCode=="13"&&submitForm("loginForm")};$("[name='vi_refresh']").bind("click",function(){$("#vi").attr("src","vi?vct=login_vc&d="+(new Date).getTime())});$("#loginModal").on("show.bs.modal",function(){$("#vi").attr("src","vi?vct=login_vc&d="+(new Date).getTime())})}
function getLogin(){$.ajax({type:"POST",url:"get_login_info",dataType:"json",success:function(a){if(a)(login=a.login)?($("[name='login_user_name']").text(a.ti_name),$("[name='login_user_introduction']").text(a.ti_introduction)):$("#loginModal").modal({keyboard:!1})},error:function(){}})}function submitForm(a){data=$("#"+a).serialize();$.ajax({type:"POST",url:"login",data:data,success:result,error:result,dataType:"json"})}
function result(a){a!=null&&a.login==!0?($("[name='loginedIcon']").toggle(),$("[name='loginIcon']").toggle(),$("#loginModal").modal("hide"),getLogin()):(tips=$("#tips-error"),a!=null&&a.message!=null?tips.text(a.message):tips.text("Login failed."),$("#vi").attr("src","vi?vct=login_vc&d="+(new Date).getTime()))};